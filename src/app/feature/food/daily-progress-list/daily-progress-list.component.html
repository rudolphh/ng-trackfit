<!-- progress bar -->
<mat-progress-bar
  mode="determinate"
  [value]="percentOfDaily"
  [ngClass]="progressBarColor()"
></mat-progress-bar>

<div class="d-flex mt-2" style="height: 51px">
  <span
    >Remaining :
    <span [ngClass]="remainingCaloriesColor()">{{ remainingCalories }}</span>
  </span>
  <div *ngIf="dbFoods.length !== 0" class="d-flex ml-auto">
    <button
      mat-flat-button
      *ngIf="foodsSelect.selectedOptions.selected.length"
      class="bg-danger mx-2"
      style="min-width: 100px"
      (click)="deleteSelected()"
    >
      <i class="fas fa-2x fa-trash-alt"></i>
    </button>

    <mat-selection-list
      (selectionChange)="selectAllChange()"
      #selectAll
      id="select-all-foods"
      class=""
      style="min-width: 64px; padding-top: 0px"
    >
      <mat-list-option
        color="warn"
        style="max-width: 64px; height: 51px"
        [selected]="allFoodsSelected"
      >
      </mat-list-option>
    </mat-selection-list>
  </div>
</div>

<!-- start foods list divider -->
<mat-divider class="mt-2 mb-3"></mat-divider>

<div
  *ngIf="dbFoods.length === 0"
  class="d-flex justify-content-center my-4 mx-3 p-3 bg-dark"
  [class.mat-elevation-z12]="true"
>
  <span class="d-flex align-items-center">
    <i
      class="fas fa-exclamation-circle text-success mx-2"
      style="font-size: 1.5em"
    ></i>
    No food today
  </span>
</div>

<form [formGroup]="foodsForm">
  <mat-selection-list #foodsSelect id="food-selection-list">
    <div
      formArrayName="foods"
      *ngFor="
        let food of foodsFormArray.controls.slice(0, maxFoodsDisplayed);
        let i = index
      "
    >
      <div [formGroupName]="i" class="d-flex justify-content-between">
        <span class="mr-2">
          <mat-form-field style="max-width: 100px" appearance="fill">
            <mat-label>Time</mat-label>
            <input
              formControlName="time"
              type="time"
              matInput
              name="time-{{ i }}"
            />
          </mat-form-field>
        </span>

        <span class="flex-grow-1">
          <mat-form-field class="w-100" appearance="fill">
            <mat-label>Food</mat-label>
            <input
              formControlName="name"
              matInput
              name="name-{{ i }}"
              placeholder="Ex. Pizza"
            />
          </mat-form-field>
        </span>

        <span class="ml-2">
          <mat-form-field style="max-width: 100px" appearance="fill">
            <mat-label>Calories</mat-label>
            <input
              formControlName="calories"
              appNumbersOnly
              matInput
              name="calories-{{ i }}"
              placeholder="250"
            />
          </mat-form-field>
        </span>

        <mat-list-option
          style="max-width: 64px; height: 51px"
          color="warn"
          class="ml-2"
          (click)="optionClick()"
          [value]="food"
        >
        </mat-list-option>
      </div>
    </div>
  </mat-selection-list>
</form>

<!-- end foods list -->
<mat-divider class="mb-2"></mat-divider>

<span class="d-flex mt-3">
  <button
    mat-flat-button
    *ngIf="dbFoods.length > 3 && dbFoods.length > maxFoodsDisplayed"
    (click)="loadMore()"
    class="
      w-100
      d-flex
      justify-content-center
      align-items-center
      bg-transparent
    "
    style="height: 51px; color: lightgrey"
  >
    <span>load</span>
    <i class="fas fa-arrow-circle-down mx-2"></i>
    <span>more</span>
  </button>

  <button
    mat-flat-button
    *ngIf="maxFoodsDisplayed > 3"
    (click)="loadReset()"
    class="bg-transparent ml-auto light-text-success"
    style="height: 51px"
  >
    <i
      class="far fa-2x fa-minus-square"
      matTooltip="Show Less"
      matTooltipPosition="left"
      matTooltipShowDelay="500"
      matTooltipHideDelay="1000"
    ></i>
  </button>
</span>
